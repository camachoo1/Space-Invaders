!function(){"use strict";!function(){var t=0,i=1,e=2,s=3;function r(t,i,e){return(i=function(t){var i=function(t,i){if("object"!=typeof t||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var s=e.call(t,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof i?i:String(i)}(i))in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}class h{constructor(t,i,e){this.x=t,this.y=i,this.width=45,this.height=30,this.image=new Image,this.image.src=`assets/images/enemy${e}.png`}move(t,i){this.x+=t,this.y+=i}draw(t){t.drawImage(this.image,this.x,this.y,this.width,this.height)}detectCollision(t){return this.x+this.width>t.x&&this.x<t.x+t.width&&this.y+this.height>t.y&&this.y<t.y+t.height}}function l(t,i,e){return(i=function(t){var i=function(t,i){if("object"!=typeof t||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var s=e.call(t,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof i?i:String(i)}(i))in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}function o(t,i,e){return(i=function(t){var i=function(t,i){if("object"!=typeof t||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var s=e.call(t,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof i?i:String(i)}(i))in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}class n{constructor(t,i,e,s,r){this.canvas=t,this.x=i,this.y=e,this.vel=s,this.color=r,this.width=5,this.height=20}draw(t){this.y-=this.vel,t.fillStyle=this.color,t.fillRect(this.x,this.y,this.width,this.height)}detectCollision(t){return this.x+this.width>t.x&&this.x<t.x+t.width&&this.y+this.height>t.y&&this.y<t.y+t.height}}class a{constructor(t,i,e){o(this,"bullets",[]),o(this,"timeTilNextBulletAllowed",0),this.canvas=t,this.maxBullets=i,this.color=e}draw(t){this.bullets=this.bullets.filter((t=>t.y+t.width>0&&t.y<=this.canvas.height)),this.bullets.forEach((i=>i.draw(t))),this.timeTilNextBulletAllowed>0&&this.timeTilNextBulletAllowed--}detectCollision(t){const i=this.bullets.findIndex((i=>i.detectCollision(t)));return i>=0&&(this.bullets.splice(i,1),!0)}shoot(t,i,e){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(this.timeTilNextBulletAllowed<=0&&this.bullets.length<this.maxBullets){const r=new n(this.canvas,t,i,e,this.color);this.bullets.push(r),this.timeTilNextBulletAllowed=s}}}document.addEventListener("DOMContentLoaded",(()=>{}));const c=document.getElementById("canvas"),d=c.getContext("2d"),u=new Image;u.src="assets/images/space.png";const v=new a(c,10,"red"),f=new a(c,5,"blue"),m=new class{constructor(t,e,s){r(this,"invadersMap",[[2,3,3,3,3,2],[2,1,1,1,1,2],[2,3,3,3,3,2],[2,1,1,1,1,2]]),r(this,"invadersRows",[]),r(this,"curDir",i),r(this,"xVel",0),r(this,"yVel",0),r(this,"defaultXVel",1),r(this,"defaultYVel",1),r(this,"defaultMoveTimer",30),r(this,"moveTimer",this.defaultMoveTimer),r(this,"fireBulletTime",100),r(this,"bulletTimer",this.fireBulletTime),this.canvas=t,this.invadersBulletsController=e,this.playerBulletsController=s,this.createInvaders()}draw(t){this.decrementMoveTimer(),this.updateVelAndDirs(),this.detectCollision(),this.drawInvaders(t),this.resetMoveDownTimer(),this.fire()}drawInvaders(t){this.invadersRows.flat().forEach((i=>{i.move(this.xVel,this.yVel),i.draw(t)}))}detectCollision(){this.invadersRows.forEach((t=>{t.forEach(((i,e)=>{this.playerBulletsController.detectCollision(i)&&t.splice(e,1)}))})),this.invadersRows=this.invadersRows.filter((t=>t.length>0))}fire(){if(this.bulletTimer--,this.bulletTimer<=0){this.bulletTimer=this.fireBulletTime;const t=this.invadersRows.flat(),i=t[Math.floor(Math.random()*t.length)];this.invadersBulletsController.shoot(i.x+i.width/2,i.y,-3)}}resetMoveDownTimer(){this.moveTimer<=0&&(this.moveTimer=this.defaultMoveTimer)}decrementMoveTimer(){this.curDir!==e&&this.curDir!==s||this.moveTimer--}updateVelAndDirs(){for(const r of this.invadersRows)if(this.curDir===i){this.xVel=this.defaultXVel,this.yVel=0;const t=r[r.length-1];if(t.x+t.width>=this.canvas.width){this.curDir=e;break}}else if(this.curDir===e){if(this.moveDown(t))break}else if(this.curDir===t){if(this.xVel=-this.defaultXVel,this.yVel=0,r[0].x<=0){this.curDir=s;break}}else if(this.curDir===s&&this.moveDown(i))break}moveDown(t){return this.xVel=0,this.yVel=this.defaultYVel,this.moveTimer<=0&&(this.curDir=t,!0)}createInvaders(){this.invadersMap.forEach(((t,i)=>{this.invadersRows[i]=[],t.forEach(((t,e)=>{t>0&&this.invadersRows[i].push(new h(50*e,35*i,t))}))}))}collideWith(t){return this.invadersRows.flat().some((i=>i.detectCollision(t)))}}(c,f,v),w=new class{constructor(t,i,e){l(this,"rightPress",!1),l(this,"leftPress",!1),l(this,"shootPress",!1),l(this,"keydown",(t=>{"ArrowRight"===t.code&&(this.rightPress=!0),"ArrowLeft"===t.code&&(this.leftPress=!0),"Space"===t.code&&(this.shootPress=!0)})),l(this,"keyup",(t=>{"ArrowRight"===t.code&&(this.rightPress=!1),"ArrowLeft"===t.code&&(this.leftPress=!1),"Space"===t.code&&(this.shootPress=!1)})),this.canvas=t,this.vel=i,this.bulletsController=e,this.x=this.canvas.width/2,this.y=this.canvas.height-50,this.width=50,this.height=50,this.image=new Image,this.image.src="assets/images/player.png",document.addEventListener("keydown",this.keydown),document.addEventListener("keyup",this.keyup)}move(){this.leftPress&&(this.x-=this.vel),this.rightPress&&(this.x+=this.vel)}draw(t){this.shootPress&&this.bulletsController.shoot(this.x+this.width/2,this.y,4,10),this.move(),this.wallCollision(),t.drawImage(this.image,this.x,this.y,this.width,this.height)}wallCollision(){this.x<0&&(this.x=0),this.x>this.canvas.width-this.width&&(this.x=this.canvas.width-this.width)}}(c,3,v);let y=!1,g=!1;const b=function(){x(),d.drawImage(u,0,0,c.width,c.height),p(),y||(m.draw(d),w.draw(d),v.draw(d),f.draw(d))},x=function(){y||(f.detectCollision(w)&&(y=!0),m.collideWith(w)&&(y=!0),0===m.invadersRows.length&&(g=!0,y=!0))},p=function(){if(y){let t=g?"You Win":"Game Over",i=g?3:5;d.fillStyle="white",d.font="70px Space Invaders",d.fillText(t,c.width/i,c.height/2)}};document.querySelector(".start-game").addEventListener("click",(function(){setInterval(b,1e3/60)}))}()}();
//# sourceMappingURL=main.js.map